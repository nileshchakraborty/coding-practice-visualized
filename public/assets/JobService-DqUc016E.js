import{a as p,g as c}from"./index-BqcDlubf.js";const l="/api",a=p.create({baseURL:l});a.interceptors.request.use(t=>{const s=c();return s&&(t.headers.Authorization=`Bearer ${s}`),t});const b={async submit(t,s){return(await a.post("/jobs/submit",{type:t,payload:s})).data},async getStatus(t){return(await a.get(`/jobs/${t}`)).data},async poll(t,s={}){const{maxAttempts:o=120,pollInterval:r=1e3,onStatusUpdate:n}=s;for(let i=0;i<o;i++){const e=await this.getStatus(t);if(n&&n(e),e.status==="completed")return e.result;if(e.status==="failed")throw new Error(e.error||"Job failed");await new Promise(u=>setTimeout(u,r))}throw new Error("Job timed out - please try again")},async submitAndPoll(t,s,o={}){const{jobId:r}=await this.submit(t,s);return this.poll(r,o)},async list(t=10){return(await a.get("/jobs",{params:{limit:t}})).data},async getStats(){return(await a.get("/jobs/stats")).data}};export{b as JobService,b as default};
